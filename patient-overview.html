<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Sat Apr 11 2020 10:40:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e913ac34660cb81d7d7ddc2" data-wf-site="5e89e56bbebe7d2e8604de36">

<head>
    <meta charset="utf-8">
    <title>Patient Overview</title>
    <meta content="Patient Overview" property="og:title">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator">
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/webflow.css" rel="stylesheet" type="text/css">
    <link href="css/safeco.webflow.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">
        WebFont.load({
            google: {
                families: ["Inter:100,200,300,regular,500,600,700,800,900", "Roboto:100,100italic,300,300italic,regular,italic,500,500italic,700,700italic,900,900italic", "Muli:200,300,regular,500,600,700,800,900,200italic,300italic,italic,500italic,600italic,700italic,800italic,900italic"]
            }
        });
    </script>
    <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
    <script type="text/javascript">
        ! function(o, c) {
            var n = c.documentElement,
                t = " w-mod-";
            n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
        }(window, document);
    </script>
    <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="images/webclip.png" rel="apple-touch-icon">
    <style>
         ::-webkit-scrollbar {
            width: 12px;
            /* Controls the overall width of the scrollbar */
            padding: 2.5px;
            /* Controls the padding of the Scrollbar */
        }
        /* Track - This is the part that contains the bit you click and drag */
        
         ::-webkit-scrollbar-track {
            background: transparent;
            /* Sets the background to transparent, change to a Hex or RGB value if you would like */
        }
        /* Handle - This is the bit you actually click and drag */
        
         ::-webkit-scrollbar-thumb {
            background: #828592;
            /* Change the Hex value to change the scroll handle */
            border-radius: 6px;
            /* Change the "px" to adjust the scroll handle's border radius*/
            border: white 1px solid/* This controls whether the scroll handle has a border, right now it's set to a White, 1px Solid border, you can change these settings or remove this line altogether if you don't want a border */
        }
        
        .SCROLLABLE-Section-4 {
            overflow-x: hidden;
        }
    </style>
</head>

<body class="body">
    <div class="div-block-4 status-form">
        <div class="div-block status-form">
            <div class="columns-4 w-row">
                <div class="w-col w-col-2">
                    <div class="div-block-2 status-form">
                        <div class="section">
                            <div class="div-block-26">
                                <div class="logo-div w-inline-block"></div>
                            </div>
                        </div>
                    </div>
                    <div class="section">
                        <a href="#" id="logout" class="logout-button w-inline-block">
                            <div>Logout</div>
                        </a>
                        <a href="patient-overview.html" aria-current="page" class="logout-button w-inline-block w--current">
                            <div class="text-block-2">Add New Patient +</div>
                        </a>
                        <a href="list-of-patients.html" class="logout-button w-inline-block">
                            <div class="text-block-2">Patients LIST</div>
                        </a>
                        <a href="status-form.html" class="logout-button  w-inline-block">
                            <div class="text-block-2">Status Form</div>
                        </a>
                    </div>
                </div>
                <div class="column w-col w-col-10">
                    <div class="div-block-44">
                        <div class="hospital-profile-header-div _1">
                            <h1 class="heading-2 _1">Patient Details</h1>
                        </div>
                        <form id="patient_form" name="patient_form" data-name="Patient Form">
                            <div class="div-block-36 _1">
                                <div class="section-7">
                                    <div class="w-row">
                                        <div class="w-col w-col-6">
                                            <div class="form-block-3 w-form">
                                                <div class="form-section-div _23">
                                                    <div class="div-block-8-copy">
                                                        <div class="patient-db-form">
                                                            <label for="patient_hospital_id" class="field-label patient">Patient ID:</label>
                                                            <input type="text" class="patient-db-text-field w-input" name="patient_hospital_id" data-name="Patient hospital Id" placeholder="Patient ID" id="patient_hospital_id" required>
                                                        </div>
                                                        <div class="patient-db-form">
                                                            <label for="name" class="field-label patient">Name:</label>
                                                            <input type="text" class="patient-db-text-field w-input" maxlength="256" name="name" data-name="Name" placeholder="Name" id="name" required>
                                                        </div>
                                                        <!-- <div class="patient-db-form">
                                                            <label for="last_name" class="field-label patient">Last Name:</label>
                                                            <input type="text" class="patient-db-text-field w-input" maxlength="256" name="last_name" data-name="Last Name" placeholder="Last Name" id="last_name" required>
                                                        </div> -->
                                                        <div class="patient-db-form">
                                                            <label for="age" class="field-label patient">Age:</label>
                                                            <input type="number" min=0 class="patient-db-text-field _1 w-input" maxlength="256" name="age" data-name="age" placeholder="age" id="age" required>
                                                            <div class="patient-db-form">
                                                                <label for="gender" class="field-label patient">Gender:</label>
                                                                <select id="gender" name="gender" data-name="gender" class="patient-db-text-field w-select" required>
                                                                    <option value="">Select one...</option>
                                                                    <option value="Male">Male</option>
                                                                    <option value="Female">Female</option>
                                                                    <option value="Other">Other</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-form-done">
                                                    <div>Thank you! Your submission has been received!</div>
                                                </div>
                                                <div class="w-form-fail">
                                                    <div>Oops! Something went wrong while submitting the form.</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-col w-col-6">
                                            <div class="form-block-3 w-form">
                                                <div class="form-section-div _2">
                                                    <div class="div-block-8-copy">
                                                        <div class="patient-db-form">
                                                            <label for="mobile_number" class="field-label patient">Mobile:</label>
                                                            <input type="number" pattern="\d{3}[\-]\d{3}[\-]\d{4}" maxlength=10 minlength=10 class="patient-db-text-field w-input" name="mobile_number" data-name="Mobile No" placeholder="+91" id="mobile_number" required>
                                                        </div>
                                                        <div class="patient-db-form">
                                                            <label for="address" class="field-label patient">Address:</label>
                                                            <input type="text" class="patient-db-text-field w-input" maxlength="256" name="address" data-name="address" placeholder="address" id="address">
                                                        </div>
                                                        <div class="patient-db-form">
                                                            <label for="emergency_contact" class="field-label patient">Emergency:</label>
                                                            <input type="number" pattern="\d{3}[\-]\d{3}[\-]\d{4}" maxlength=10 minlength=10 class="patient-db-text-field w-input" name="emergency_contact" data-name="Emergency COntact" placeholder="+91 " id="emergency_contact">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-form-done">
                                                    <div>Thank you! Your submission has been received!</div>
                                                </div>
                                                <div class="w-form-fail">
                                                    <div>Oops! Something went wrong while submitting the form.</div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <div class="w-col w-col-6">
                                            <div class="form-block-3 w-form">
                                                <div class="form-section-div _2">
                                                    <div class="div-block-8-copy">
                                                        <div class="patient-db-form">
                                                            <input type="submit" class="signup-button status-form _2 _1 w-button" value="Save" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                                <!-- </form>
                        <form id="patient_status_form" name="patient_status_form" data-name="Patient Status Form"> -->
                                <div class="section-9">
                                    <div class="w-row">
                                        <div class="w-col w-col-6">
                                            <div class="form-block-3 w-form">
                                                <div class="form-section-div _23">
                                                    <div class="div-block-8-copy _1">
                                                        <div class="patient-db-form">
                                                            <label for="severity" class="field-label patient white">Severity:</label>
                                                            <select id="severity" name="severity" data-name="Field 4" class="patient-db-text-field w-select">
                                                                <option value="NO_SYMPTOMS">No Symptoms</option>
                                                                <option value="MILD">Mild</option>
                                                                <option value="MODERATE">Moderate</option>
                                                                <option value="SEVERE">Severe</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-form-done">
                                                    <div>Thank you! Your submission has been received!</div>
                                                </div>
                                                <div class="w-form-fail">
                                                    <div>Oops! Something went wrong while submitting the form.</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-col w-col-6">
                                            <div class="form-block-3 w-form">
                                                <div class="form-section-div _23 _1">
                                                    <div class="div-block-8-copy _1">
                                                        <div class="patient-db-form">
                                                            <label for="test_status" class="field-label patient white">Test:</label>
                                                            <select id="test_status" name="test_status" data-name="Field 4" class="patient-db-text-field w-select">
                                                                <option value="PENDING_TEST">Test Pending</option>
                                                                <option value="PENDING_RESULT">Test Result Pending</option>
                                                                <option value="POSITIVE">Positive</option>
                                                                <option value="NEGATIVE">Negative</option>
                                                                
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-form-done">
                                                    <div>Thank you! Your submission has been received!</div>
                                                </div>
                                                <div class="w-form-fail">
                                                    <div>Oops! Something went wrong while submitting the form.</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="div-block-45">
                                    <div class="text-block-7">List of ALL Available Facilities</div>
                                    <div class="section-8">
                                        <div class="columns-6 w-row">
                                            <!-- <div class="w-col w-col-1">
                                                <a href="#" class="link-block-3 _1 w-inline-block">
                                                    <div class="legends">Sr No</div>
                                                </a>
                                            </div> -->
                                            <div class="w-col w-col-3">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Facility</div>
                                                </a>
                                            </div>
                                            <!-- <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Telephone</div>
                                                </a>
                                            </div> -->
                                            <div class="w-col w-col-3">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Location</div>
                                                </a>
                                            </div>
                                            <!-- <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Jurisdiction</div>
                                                </a>
                                            </div> -->
                                            <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Availability</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-3">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Covid Facility Type</div>
                                                </a>
                                            </div>
                                            <!-- <div class="w-col w-col-1">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Facility Type</div>
                                                </a>
                                            </div> -->
                                            <div class="w-col w-col-1">
                                                <a href="#" class="link-block-3 _1 w-inline-block">
                                                    <div class="legends">ACtion</div>
                                                </a>
                                            </div>
                                        </div>
                                        <div id="facility_list" class="div-block-42">
                                            <!-- <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div> -->
                                        </div>
                                    </div>
                                    <div class="section-8 ward">
                                        <div class="columns-6 w-row">
                                            <!-- <div class="w-col w-col-1">
                                                <a href="#" class="link-block-3 _1 w-inline-block">
                                                    <div class="legends">Sr No</div>
                                                </a>
                                            </div> -->
                                            <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Ward</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Available Beds</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Total Beds</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-2">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Severity</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-3">
                                                <a href="#" class="link-block-3 w-inline-block">
                                                    <div class="legends">Covid Ward Type</div>
                                                </a>
                                            </div>
                                            <div class="w-col w-col-1">
                                                <a href="#" class="link-block-3 _1 w-inline-block">
                                                    <div class="legends">ACtion</div>
                                                </a>
                                            </div>
                                        </div>
                                        <div id="ward_list" class="div-block-42 ward">
                                            <!-- <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div>
                                            <div class="columns-7 w-row">
                                                <div class="w-col w-col-1">
                                                    <div class="pd-list">1</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">Facility</div>
                                                </div>
                                                <div class="w-col w-col-4">
                                                    <div class="pd-list">location</div>
                                                </div>
                                                <div class="w-col w-col-2">
                                                    <div class="pd-list">availability</div>
                                                </div>
                                                <div class="w-col w-col-1"><a href="#" class="button-2 w-button">select</a></div>
                                            </div> -->
                                        </div>
                                    </div>
                                </div>
                                <div class="div-block-43"><input type='reset' id="cancel_button" class="signup-button status-form _2 cancel w-button" value="CANCEL" /><input type="submit" class="signup-button status-form _2 _1 w-button" value="Save" /></div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js?site=5e89e56bbebe7d2e8604de36" type="text/javascript" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="js/config.js" type="text/javascript"></script>
    <script src="js/webflow.js" type="text/javascript"></script>
    <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-firestore.js"></script>
    <script>
        // Your web app's Firebase configuration
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
    <script>
        $(document).ready(function() {
            var dataAuthToken = {
                "authToken": window.localStorage.getItem("authToken")
            };
            var headers = {
                "Content-Type": "application/json"
            };
            $("#logout").click(function() {
                firebase.auth().signOut().then(function() {
                    // Sign-out successful.
                    window.localStorage.removeItem("authToken");
                    window.location.href = "index.html";
                }).catch(function(error) {
                    alert("Error in Sign-out." + error);
                });
            });
            if (window.localStorage.getItem("authToken") == null) {
                $("#logout").click(); //logout if authToken is not available
                return;
            }
            $.urlParam = function(name) {
                var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
                if (results == null) {
                    return null;
                }
                return decodeURI(results[1]) || 0;
            }
            updatePatient = false;
            patientProfileData = null;
            patientStatusData = null;
            userFacility = null;
            selectedFacilityId = 0;
            selectedWardId = 0;

            fetchUser();

            function fetchUser() {
                var userProfileURL = apiURL + "hospital/user/profile";
                $.ajax({
                    type: "POST",
                    url: userProfileURL,
                    data: JSON.stringify(dataAuthToken),
                    headers: headers,
                    success: function(res) {
                        var userData = res.data;
                        var userProfile = userData.profile;
                        fetchFacilityUsingId(userProfile.facilityId);
                    }, //userProfile success function ends
                    error: function(jqXHR, textStatus, error) {
                        alert("user profile error: " + error);
                    },
                }); //ajax userProfile 

            }
            $("#cancel_button").click(function(e) {
                if (updatePatient) {
                    try {
                        refreshPatientProfile();
                    } catch (e) {
                        log("refreshPatientProfile Error:", e);
                    }
                    try {
                        refreshPatientStatus();
                    } catch (e) {
                        log("refreshPatientStatus Error:", e);
                    }
                    e.preventDefault();
                }
            });

            function refreshPatientStatus() {
                $("#severity").val(patientStatusData.severity);
                $("#test_status").val(patientStatusData.testStatus);
                fetchFacility();
            }

            function refreshPatientProfile() {
                $("#patient_hospital_id").val(patientProfileData.patientHospitalId);
                $("#name").val(patientProfileData.name);
                $("#mobile_number").val(patientProfileData.contactNumber);
                $("#emergency_contact").val(patientProfileData.emergencyContact);
                $("#gender").val(patientProfileData.gender);
                $("#age").val(patientProfileData.age);
                $("#address").val(patientProfileData.address);
            }

            $("#patient_form").submit(function(e) {
                if (!updatePatient) {
                    if (selectedFacilityId == 0) {
                        alert("Please select a facility");
                        e.preventDefault();
                        return;
                    }
                    data = {
                        "authToken": window.localStorage.getItem("authToken"),
                        "address": $("#address").val(),
                        "age": $("#age").val(),
                        "contactNumber": $("#mobile_number").val(),
                        "gender": $("#gender").val(),
                        "name": $("#name").val(),
                        "patientHospitalId": $("#patient_hospital_id").val(),
                        "emergencyContact": $("#emergency_contact").val(),
                        "facilityId": selectedFacilityId,
                        "severity": $("#severity").val(),
                        "testStatus": $("#test_status").val(),
                        "wardId": selectedWardId,
                    };
                    newPatientURL = apiURL + "patients/new";
                    $.ajax({
                        type: "POST",
                        url: newPatientURL,
                        data: JSON.stringify(data),
                        headers: headers,
                        success: function(res) {
                            if (res.data.success) {
                                alert("Patient Added");
                                window.location.href = "list-of-patients.html";
                            } else {
                                alert("Error in adding patient:" + res.error)
                            }
                        }, //success function ends
                        error: function(jqXHR, textStatus, error) {
                            alert("error: " + error);
                        },
                    }); //register new patient 
                } else {
                    updatePatientProfile();
                    updatePatientStatus();
                }
                e.preventDefault();

            }); // patient form submit
            function updatePatientProfile() {
                data = {
                    "authToken": window.localStorage.getItem("authToken"),
                    "address": $("#address").val(),
                    "age": $("#age").val(),
                    "contactNumber": $("#mobile_number").val(),
                    "emergencyContact": $("#emergency_contact").val(),
                    "gender": $("#gender").val(),
                    "name": $("#name").val(),
                    "patientHospitalId": $("#patient_hospital_id").val(),
                };
                updatePatientProfileURL = apiURL + "patients/" + $.urlParam("patient_id") + "/profile/post";
                $.ajax({
                    type: "POST",
                    url: updatePatientProfileURL,
                    data: JSON.stringify(data),
                    headers: headers,
                    success: function(res) {
                        log("Update Patient Profile Response", res);
                        if (res.error == null)
                            alert("Profile updated");
                        else
                            alert("Profile update error:" + res.error);
                    }, //success function ends
                    error: function(jqXHR, textStatus, error) {
                        alert("Profile update request error: " + error);
                    },
                });
            }

            function updatePatientStatus() {
                data = {
                    "authToken": window.localStorage.getItem("authToken"),
                    "facilityId": selectedFacilityId,
                    "severity": $("#severity").val(),
                    "testStatus": $("#test_status").val(),
                    "wardId": selectedWardId,
                    // "patientId": $.urlParam("patient_id"),
                };
                updatePatientStatusURL = apiURL + "patients/" + $.urlParam("patient_id") + "/status/post";
                // updatePatientStatusURL = apiURL + "patient/status/update";
                $.ajax({
                    type: "POST",
                    url: updatePatientStatusURL,
                    data: JSON.stringify(data),
                    headers: headers,
                    success: function(res) {
                        log("Update Patient Profile Response", res);
                        if (res.data.success)
                            alert("Status updated");
                        else
                            alert("Status update error:" + res.error);
                    }, //success function ends
                    error: function(jqXHR, textStatus, error) {
                        alert("Status update request error: " + error);
                    },
                });
            } //updatePatientStatus

            $("#severity").change(function(e) {
                fetchFacility();
            }); //severity change
            $("#test_status").change(function(e) {
                fetchFacility();
            }); //test_status change

            function fetchFacility() {
                data = {
                    "authToken": window.localStorage.getItem("authToken"),
                    "severity": $("#severity").val(),
                    "testStatus": $("#test_status").val(),
                    // "facilityId": userFacility.facilityId,
                }
                fetchFacilityURL = apiURL + "facilities";
                $.ajax({
                    type: "POST",
                    url: fetchFacilityURL,
                    data: JSON.stringify(data),
                    headers: headers,
                    success: function(res) {
                        if (updatePatient)
                            selectedFacilityId = patientStatusData.facilityId;
                        showFacility(res.data.list);
                    }, //success function ends
                    error: function(jqXHR, textStatus, error) {
                        alert("error: " + error);
                    },
                }); //fetch Facility ajax
            } //fetchFacility
            function fetchFacilityUsingId(facilityId) {
                data = {
                    "authToken": window.localStorage.getItem("authToken"),
                    "severity": $("#severity").val(),
                    "testStatus": $("#test_status").val(),
                }
                fetchFacilityURL = apiURL + "facility/" + facilityId;
                $.ajax({
                    type: "POST",
                    url: fetchFacilityURL,
                    data: JSON.stringify(data),
                    headers: headers,
                    success: function(res) {
                        log("User Facility Response:", res);
                        userFacility = res.data;
                        fetchUserData();
                    }, //success function ends
                    error: function(jqXHR, textStatus, error) {
                        alert("error: " + error);
                    },
                }); //fetch Facility ajax
            } //fetchFacility
            function fetchUserData() {
                if ($.urlParam("patient_id") != null) {
                    //get patient details
                    updatePatient = true;
                    patientId = $.urlParam("patient_id");
                    patientProfileURL = apiURL + "patients/" + patientId + "/profile/get";
                    $.ajax({
                        type: "POST",
                        url: patientProfileURL,
                        data: JSON.stringify(dataAuthToken),
                        headers: headers,
                        success: function(res) {
                            patientProfileData = res.data.profile;
                            log("Patient profile response", res)
                            refreshPatientProfile();
                        }, //success function ends
                        error: function(jqXHR, textStatus, error) {
                            alert("error: " + error);
                        },
                    }); //get patient profile
                    patientStatusURL = apiURL + "patients/" + patientId + "/status/get";
                    $.ajax({
                        type: "POST",
                        url: patientStatusURL,
                        data: JSON.stringify(dataAuthToken),
                        headers: headers,
                        success: function(res) {
                            patientStatusData = res.data.patientStatus;
                            log("Patient Status Data: ", patientStatusData);
                            log("User Facility: ", userFacility);
                            if (patientStatusData.facilityId != userFacility.facilityId) {
                                $("#logout").click();
                            }
                            log("patient status data: ", res);
                            refreshPatientStatus();
                        }, //success function ends
                        error: function(jqXHR, textStatus, error) {
                            alert("error: " + error);
                        },
                    }); //get patient profile
                } else {
                    //no patient
                    // alert("no patient");
                    fetchFacility();
                    fetchWards();
                }
            }

            $.selectFacility = function(facilityId) {
                $("#facility_" + selectedFacilityId).html("Select");
                $("#facility_" + selectedFacilityId).css("background-color", "#4c72bf");
                $("#facility_" + facilityId).html("Selected");
                $("#facility_" + facilityId).css("background-color", "green");
                selectedFacilityId = facilityId;
                selectedWardId = 0;
                fetchWards();
            }

            function showFacility(facilities) {
                log("Facilities to show: ", facilities);
                facilityListHTML = "";
                userFacilityListItem = "";
                // userFacilityRowShown = false;
                facilities.forEach(function(facility, index) {
                    facilityName = facility.name;
                    telephone = facility.telephone;
                    area = facility.area;
                    availability = facility.availability;
                    covidFacilityType = facility.covidFacilityType;
                    facilityId = facility.facilityId;
                    row = '<div class="columns-7 w-row">\
                                <div class="w-col w-col-3">\
                                    <div class="pd-list">' + facilityName + '</div>\
                                </div>\
                                <div class="w-col w-col-3">\
                                    <div class="pd-list">' + area + '</div>\
                                </div>\
                                <div class="w-col w-col-2">\
                                    <div class="pd-list">' + availability + '</div>\
                                </div>\
                                <div class="w-col w-col-3">\
                                    <div class="pd-list">' + covidFacilityType + '</div>\
                                </div>\
                                <div class="w-col w-col-1"><a href="#" id="facility_' + facilityId + '" onClick="$.selectFacility(' + facilityId + ')" class="button-2 w-button">select</a></div>\
                            </div>';
                    if (facilityId == userFacility.facilityId) {
                        facilityListHTML = row + facilityListHTML;
                        // userFacilityRowShown = true;
                    } else {
                        facilityListHTML += row;
                    }
                }); //forEach facilities
                // if (!userFacilityRowShown) {
                //     showFacility([userFacility]);
                // }
                $("#facility_list").html(facilityListHTML);
                $.selectFacility(selectedFacilityId);
            } //showFacility

            function fetchWards() {
                if (selectedFacilityId == userFacility.facilityId) {
                    wardsURL = apiURL + "facilities/" + userFacility.facilityId + "/wards";
                    if (updatePatient)
                        selectedWardId = patientStatusData.wardId;
                    $.ajax({
                        type: "POST",
                        url: wardsURL,
                        data: JSON.stringify(dataAuthToken),
                        headers: headers,
                        success: function(res) {
                            log("Wards response", res);
                            showWards(res.data.list);
                        }, //success function ends
                        error: function(jqXHR, textStatus, error) {
                            alert("error: " + error);
                        },
                    }); //fetch wards ajax
                } else {
                    selectedWardId = 0;
                    showWards([]);
                }
            }

            $.selectWard = function(wardId) {
                $("#ward_" + selectedWardId).html("Select");
                $("#ward_" + selectedWardId).css("background-color", "#4c72bf");
                $("#ward_" + wardId).html("Selected");
                $("#ward_" + wardId).css("background-color", "green");
                selectedWardId = wardId;
            }

            function showWards(wards) {
                log("Wards:", wards);
                wardListHTML = "";
                wards.forEach(function(ward, index) {
                    row = '<div class="columns-7 w-row">\
                                <div class="w-col w-col-2">\
                                    <div class="pd-list">' + ward.name + '</div>\
                                </div>\
                                <div class="w-col w-col-2">\
                                    <div class="pd-list">' + ward.availableBeds + '</div>\
                                </div>\
                                <div class="w-col w-col-2">\
                                    <div class="pd-list">' + ward.totalBeds + '</div>\
                                </div>\
                                <div class="w-col w-col-2">\
                                    <div class="pd-list">' + ward.severity + '</div>\
                                </div>\
                                <div class="w-col w-col-3">\
                                    <div class="pd-list">' + ward.covidStatus + '</div>\
                                </div>\
                                <div class="w-col w-col-1"><a href="#" id="ward_' + ward.id + '" onClick="$.selectWard(' + ward.id + ')" class="button-2 w-button">select</a></div>\
                            </div>';
                    wardListHTML += row;
                }); //forEach
                $("#ward_list").html(wardListHTML);
                $.selectWard(selectedWardId);
            }
        }); //document ready
    </script>
</body>

</html>